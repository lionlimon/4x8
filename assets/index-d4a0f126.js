import{u as l,y as je,r as V,z as Te,w as T,k as N,p as ne,A as Pe,c as h,B as Ae,C as Ue,D as ae,E as re,G as oe,d as P,o as x,a as C,g as k,t as q,l as b,V as J,h as I,e as W,b as j,H as ze,I as Le,_ as A,s as R,T as ve,F as _e,f as me,J as ge,j as Ne,v as We,K as Me}from"./index-acc4240a.js";import{u as K,V as H,a as Fe}from"./VButton-e9ceffce.js";import{w as ee,V as he,u as $e,a as qe,E as ye,D as Ge,S as Je,T as He,f as ie}from"./DeletionConfirmModal-1b9611d0.js";import{V as Ze,a as Ke,b as Qe,c as Xe}from"./VSelect-f3063adb.js";const xe=t=>{if(t=l(t),Array.isArray(t))return!!t.length;if(t==null)return!1;if(t===!1)return!0;if(t instanceof Date)return!isNaN(t.getTime());if(typeof t=="object"){for(let s in t)return!0;return!1}return!!String(t).length};function U(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return e=>(e=l(e),!xe(e)||s.every(a=>(a.lastIndex=0,a.test(e))))}U(/^[a-zA-Z]*$/);U(/^[a-zA-Z0-9]*$/);U(/^\d*(\.\d+)?$/);const Ye=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;U(Ye);function et(t){return typeof t=="string"&&(t=t.trim()),xe(t)}var tt={$validator:et,$message:"Value is required",$params:{type:"required"}};const nt=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i;U(nt);U(/(^[0-9]*$)|(^-[0-9]+$)/);U(/^[-]?\d*(\.\d+)?$/);function le(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);s&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,e)}return n}function S(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?le(Object(n),!0).forEach(function(e){st(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function st(t,s,n){return s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function ce(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(t).reduce((n,e)=>(s.includes(e)||(n[e]=l(t[e])),n),{})}function Z(t){return typeof t=="function"}function at(t){return Ae(t)||Ue(t)}function be(t,s,n){let e=t;const a=s.split(".");for(let c=0;c<a.length;c++){if(!e[a[c]])return n;e=e[a[c]]}return e}function Y(t,s,n){return h(()=>t.some(e=>be(s,e,{[n]:!1})[n]))}function ue(t,s,n){return h(()=>t.reduce((e,a)=>{const c=be(s,a,{[n]:!1})[n]||[];return e.concat(c)},[]))}function we(t,s,n,e){return t.call(e,l(s),l(n),e)}function Ve(t){return t.$valid!==void 0?!t.$valid:!t}function rt(t,s,n,e,a,c,p){let{$lazy:u,$rewardEarly:d}=a,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],i=arguments.length>8?arguments[8]:void 0,f=arguments.length>9?arguments[9]:void 0,$=arguments.length>10?arguments[10]:void 0;const g=V(!!e.value),r=V(0);n.value=!1;const m=T([s,e].concat(o,$),()=>{if(u&&!e.value||d&&!f.value&&!n.value)return;let v;try{v=we(t,s,i,p)}catch(y){v=Promise.reject(y)}r.value++,n.value=!!r.value,g.value=!1,Promise.resolve(v).then(y=>{r.value--,n.value=!!r.value,c.value=y,g.value=Ve(y)}).catch(y=>{r.value--,n.value=!!r.value,c.value=y,g.value=!0})},{immediate:!0,deep:typeof s=="object"});return{$invalid:g,$unwatch:m}}function ot(t,s,n,e,a,c,p,u){let{$lazy:d,$rewardEarly:o}=e;const i=()=>({}),f=h(()=>{if(d&&!n.value||o&&!u.value)return!1;let $=!0;try{const g=we(t,s,p,c);a.value=g,$=Ve(g)}catch(g){a.value=g}return $});return{$unwatch:i,$invalid:f}}function it(t,s,n,e,a,c,p,u,d,o,i){const f=V(!1),$=t.$params||{},g=V(null);let r,m;t.$async?{$invalid:r,$unwatch:m}=rt(t.$validator,s,f,n,e,g,a,t.$watchTargets,d,o,i):{$invalid:r,$unwatch:m}=ot(t.$validator,s,n,e,g,a,d,o);const v=t.$message;return{$message:Z(v)?h(()=>v(ce({$pending:f,$invalid:r,$params:ce($),$model:s,$response:g,$validator:c,$propertyPath:u,$property:p}))):v||"",$params:$,$pending:f,$invalid:r,$response:g,$unwatch:m}}function lt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=l(t),n=Object.keys(s),e={},a={},c={};let p=null;return n.forEach(u=>{const d=s[u];switch(!0){case Z(d.$validator):e[u]=d;break;case Z(d):e[u]={$validator:d};break;case u==="$validationGroups":p=d;break;case u.startsWith("$"):c[u]=d;break;default:a[u]=d}}),{rules:e,nestedValidators:a,config:c,validationGroups:p}}const ct="__root";function ut(t,s,n,e,a,c,p,u,d){const o=Object.keys(t),i=e.get(a,t),f=V(!1),$=V(!1),g=V(0);if(i){if(!i.$partial)return i;i.$unwatch(),f.value=i.$dirty.value}const r={$dirty:f,$path:a,$touch:()=>{f.value||(f.value=!0)},$reset:()=>{f.value&&(f.value=!1)},$commit:()=>{}};return o.length?(o.forEach(m=>{r[m]=it(t[m],s,r.$dirty,c,p,m,n,a,d,$,g)}),r.$externalResults=h(()=>u.value?[].concat(u.value).map((m,v)=>({$propertyPath:a,$property:n,$validator:"$externalResults",$uid:`${a}-externalResult-${v}`,$message:m,$params:{},$response:null,$pending:!1})):[]),r.$invalid=h(()=>{const m=o.some(v=>l(r[v].$invalid));return $.value=m,!!r.$externalResults.value.length||m}),r.$pending=h(()=>o.some(m=>l(r[m].$pending))),r.$error=h(()=>r.$dirty.value?r.$pending.value||r.$invalid.value:!1),r.$silentErrors=h(()=>o.filter(m=>l(r[m].$invalid)).map(m=>{const v=r[m];return ne({$propertyPath:a,$property:n,$validator:m,$uid:`${a}-${m}`,$message:v.$message,$params:v.$params,$response:v.$response,$pending:v.$pending})}).concat(r.$externalResults.value)),r.$errors=h(()=>r.$dirty.value?r.$silentErrors.value:[]),r.$unwatch=()=>o.forEach(m=>{r[m].$unwatch()}),r.$commit=()=>{$.value=!0,g.value=Date.now()},e.set(a,t,r),r):(i&&e.set(a,t,r),r)}function dt(t,s,n,e,a,c,p){const u=Object.keys(t);return u.length?u.reduce((d,o)=>(d[o]=te({validations:t[o],state:s,key:o,parentKey:n,resultsCache:e,globalConfig:a,instance:c,externalResults:p}),d),{}):{}}function pt(t,s,n){const e=h(()=>[s,n].filter(r=>r).reduce((r,m)=>r.concat(Object.values(l(m))),[])),a=h({get(){return t.$dirty.value||(e.value.length?e.value.every(r=>r.$dirty):!1)},set(r){t.$dirty.value=r}}),c=h(()=>{const r=l(t.$silentErrors)||[],m=e.value.filter(v=>(l(v).$silentErrors||[]).length).reduce((v,y)=>v.concat(...y.$silentErrors),[]);return r.concat(m)}),p=h(()=>{const r=l(t.$errors)||[],m=e.value.filter(v=>(l(v).$errors||[]).length).reduce((v,y)=>v.concat(...y.$errors),[]);return r.concat(m)}),u=h(()=>e.value.some(r=>r.$invalid)||l(t.$invalid)||!1),d=h(()=>e.value.some(r=>l(r.$pending))||l(t.$pending)||!1),o=h(()=>e.value.some(r=>r.$dirty)||e.value.some(r=>r.$anyDirty)||a.value),i=h(()=>a.value?d.value||u.value:!1),f=()=>{t.$touch(),e.value.forEach(r=>{r.$touch()})},$=()=>{t.$commit(),e.value.forEach(r=>{r.$commit()})},g=()=>{t.$reset(),e.value.forEach(r=>{r.$reset()})};return e.value.length&&e.value.every(r=>r.$dirty)&&f(),{$dirty:a,$errors:p,$invalid:u,$anyDirty:o,$error:i,$pending:d,$touch:f,$reset:g,$silentErrors:c,$commit:$}}function te(t){let{validations:s,state:n,key:e,parentKey:a,childResults:c,resultsCache:p,globalConfig:u={},instance:d,externalResults:o}=t;const i=a?`${a}.${e}`:e,{rules:f,nestedValidators:$,config:g,validationGroups:r}=lt(s),m=S(S({},u),g),v=e?h(()=>{const w=l(n);return w?l(w[e]):void 0}):n,y=S({},l(o)||{}),M=h(()=>{const w=l(o);return e?w?l(w[e]):void 0:w}),z=ut(f,v,e,p,i,m,d,M,n),_=dt($,v,i,p,m,d,M),E={};r&&Object.entries(r).forEach(w=>{let[D,B]=w;E[D]={$invalid:Y(B,_,"$invalid"),$error:Y(B,_,"$error"),$pending:Y(B,_,"$pending"),$errors:ue(B,_,"$errors"),$silentErrors:ue(B,_,"$silentErrors")}});const{$dirty:O,$errors:F,$invalid:L,$anyDirty:Oe,$error:Re,$pending:Q,$touch:X,$reset:Ce,$silentErrors:ke,$commit:se}=pt(z,_,c),Be=e?h({get:()=>l(v),set:w=>{O.value=!0;const D=l(n),B=l(o);B&&(B[e]=y[e]),N(D[e])?D[e].value=w:D[e]=w}}):null;e&&m.$autoDirty&&T(v,()=>{O.value||X();const w=l(o);w&&(w[e]=y[e])},{flush:"sync"});async function Se(){return X(),m.$rewardEarly&&(se(),await oe()),await oe(),new Promise(w=>{if(!Q.value)return w(!L.value);const D=T(Q,()=>{w(!L.value),D()})})}function Ie(w){return(c.value||{})[w]}function De(){N(o)?o.value=y:Object.keys(y).length===0?Object.keys(o).forEach(w=>{delete o[w]}):Object.assign(o,y)}return ne(S(S(S({},z),{},{$model:Be,$dirty:O,$error:Re,$errors:F,$invalid:L,$anyDirty:Oe,$pending:Q,$touch:X,$reset:Ce,$path:i||ct,$silentErrors:ke,$validate:Se,$commit:se},c&&{$getResultsForChild:Ie,$clearExternalResults:De,$validationGroups:E}),_))}class ft{constructor(){this.storage=new Map}set(s,n,e){this.storage.set(s,{rules:n,result:e})}checkRulesValidity(s,n,e){const a=Object.keys(e),c=Object.keys(n);return c.length!==a.length||!c.every(u=>a.includes(u))?!1:c.every(u=>n[u].$params?Object.keys(n[u].$params).every(d=>l(e[u].$params[d])===l(n[u].$params[d])):!0)}get(s,n){const e=this.storage.get(s);if(!e)return;const{rules:a,result:c}=e,p=this.checkRulesValidity(s,n,a),u=c.$unwatch?c.$unwatch:()=>({});return p?c:{$dirty:c.$dirty,$partial:!0,$unwatch:u}}}const G={COLLECT_ALL:!0,COLLECT_NONE:!1},de=Symbol("vuelidate#injectChildResults"),pe=Symbol("vuelidate#removeChildResults");function vt(t){let{$scope:s,instance:n}=t;const e={},a=V([]),c=h(()=>a.value.reduce((i,f)=>(i[f]=l(e[f]),i),{}));function p(i,f){let{$registerAs:$,$scope:g,$stopPropagation:r}=f;r||s===G.COLLECT_NONE||g===G.COLLECT_NONE||s!==G.COLLECT_ALL&&s!==g||(e[$]=i,a.value.push($))}n.__vuelidateInjectInstances=[].concat(n.__vuelidateInjectInstances||[],p);function u(i){a.value=a.value.filter(f=>f!==i),delete e[i]}n.__vuelidateRemoveInstances=[].concat(n.__vuelidateRemoveInstances||[],u);const d=ae(de,[]);re(de,n.__vuelidateInjectInstances);const o=ae(pe,[]);return re(pe,n.__vuelidateRemoveInstances),{childResults:c,sendValidationResultsToParent:d,removeValidationResultsFromParent:o}}function Ee(t){return new Proxy(t,{get(s,n){return typeof s[n]=="object"?Ee(s[n]):h(()=>s[n])}})}let fe=0;function _t(t,s){var n;let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(e=t,t=void 0,s=void 0);let{$registerAs:a,$scope:c=G.COLLECT_ALL,$stopPropagation:p,$externalResults:u,currentVueInstance:d}=e;const o=d||((n=je())===null||n===void 0?void 0:n.proxy),i=o?o.$options:{};a||(fe+=1,a=`_vuelidate_${fe}`);const f=V({}),$=new ft,{childResults:g,sendValidationResultsToParent:r,removeValidationResultsFromParent:m}=o?vt({$scope:c,instance:o}):{childResults:V({})};if(!t&&i.validations){const v=i.validations;s=V({}),Te(()=>{s.value=o,T(()=>Z(v)?v.call(s.value,new Ee(s.value)):v,y=>{f.value=te({validations:y,state:s,childResults:g,resultsCache:$,globalConfig:e,instance:o,externalResults:u||o.vuelidateExternalResults})},{immediate:!0})}),e=i.validationsConfig||e}else{const v=N(t)||at(t)?t:ne(t||{});T(v,y=>{f.value=te({validations:y,state:s,childResults:g,resultsCache:$,globalConfig:e,instance:o??{},externalResults:u})},{immediate:!0})}return o&&(r.forEach(v=>v(f,{$registerAs:a,$scope:c,$stopPropagation:p})),Pe(()=>m.forEach(v=>v(a)))),h(()=>S(S({},l(f.value)),g.value))}const mt=(t,s)=>{const n=String(s).split(".");let e=t;for(const a of n)if(e&&typeof e=="object"&&a in e)e=e[a];else return;return e},gt=(t,s)=>{const n=Object.keys(s),e=V({}),a=()=>{n.forEach(o=>e.value[o]=[])};a();const c=o=>e.value=o,p=_t(t,s,{$externalResults:e}),u=h(()=>o=>{var f,$,g;const i=(g=($=(f=p.value[o])==null?void 0:f.$errors)==null?void 0:$[0])==null?void 0:g.$message;return(N(i)?i.value:i)??""});return{serverErrors:e,getError:u,validation:p,setInitialServerErrors:a,syncServerErrors:c,touch:o=>{var i,f;(f=(i=mt(p.value,o))==null?void 0:i.$touch)==null||f.call(i)}}},ht=t=>{const s=JSON.stringify(t);return JSON.parse(s)},$t=t=>(ze("data-v-ce7be66e"),t=t(),Le(),t),yt={class:"exercise-approach"},xt={class:"exercise-approach__head"},bt={class:"exercise-approach__count"},wt={class:"exercise-approach__actions"},Vt={class:"exercise-approach__actions-group"},Et=$t(()=>k("div",{class:"exercise-approach__actions-title"},"Повторения",-1)),Ot={class:"exercise-approach__actions-group"},Rt={class:"exercise-approach__actions-title"},Ct={class:"exercise-approach__weight-input"},kt=P({__name:"ExerciseApproach",props:{approach:{},index:{},isBasedOnBodyWeight:{type:Boolean},weightUnit:{}},emits:["delete-click","update:approach"],setup(t,{emit:s}){const n=s,e=t,a=K(e,"approach",n),c=h(()=>{const p=ee[e.weightUnit];return`${e.isBasedOnBodyWeight?"Доп. вес":"Вес"} (${p})`});return(p,u)=>(x(),C("div",yt,[k("div",xt,[k("div",bt,q(p.index+1)+" подход ",1),k("button",{type:"button",class:"exercise-approach__delete",onClick:u[0]||(u[0]=d=>n("delete-click",p.approach.id))},[b(l(J),{name:"trash",width:"18",height:"18"})])]),k("div",wt,[k("div",Vt,[Et,b(l(Ze),{modelValue:l(a).reps,"onUpdate:modelValue":u[1]||(u[1]=d=>l(a).reps=d)},null,8,["modelValue"])]),k("div",Ot,[k("div",Rt,q(c.value),1),k("div",Ct,[p.isBasedOnBodyWeight?(x(),I(l(J),{key:0,class:"exercise-approach__weight-input-icon",name:"body",width:"25",height:"24"})):W("",!0),j(" "+q(p.isBasedOnBodyWeight?"+":null)+" ",1),b(l(Ke),{inputmode:"numeric",type:"number",modelValue:l(a).weight,"onUpdate:modelValue":u[2]||(u[2]=d=>l(a).weight=d)},null,8,["modelValue"])])])])]))}});const Bt=A(kt,[["__scopeId","data-v-ce7be66e"]]),St={class:"exercise-top-bar"},It={class:"exercise-top-bar__actions"},Dt={key:0,class:"exercise-top-bar__settings"},jt=P({__name:"ExerciseTopBar",props:{modelValue:{},hideDeletion:{type:Boolean}},emits:["update:modelValue","delete-exercise-click"],setup(t,{emit:s}){const n=V(!1),e=t,a=s,c=K(e,"modelValue",a),p=Object.keys(ee).map(d=>({title:ee[d],value:d})),u=h(()=>n.value?"Закрыть":"Параметры");return(d,o)=>(x(),C("div",St,[k("div",It,[b(l(H),{variant:"outline",onClick:o[0]||(o[0]=i=>n.value=!n.value)},{default:R(()=>[b(l(J),{name:"settings"}),j(" "+q(u.value),1)]),_:1}),d.hideDeletion?(x(),I(l(he),{key:0,theme:"dangerous",icon:"trash",onClick:o[1]||(o[1]=i=>a("delete-exercise-click"))})):W("",!0)]),b(ve,{name:"fade",mode:"out-in"},{default:R(()=>[n.value?(x(),C("div",Dt,[b(l(Qe),{modelValue:l(c).bodyWeight,"onUpdate:modelValue":o[2]||(o[2]=i=>l(c).bodyWeight=i)},{default:R(()=>[j("Собственный вес")]),_:1},8,["modelValue"]),b(l(Xe),{modelValue:l(c).weightUnit,"onUpdate:modelValue":o[3]||(o[3]=i=>l(c).weightUnit=i),options:l(p)},{default:R(()=>[j("Ед. Измерения")]),_:1},8,["modelValue","options"])])):W("",!0)]),_:1})]))}});const Tt=A(jt,[["__scopeId","data-v-3d6f6688"]]),Pt={key:0,class:"approaches-list"},At={key:1,class:"empty-message"},Ut=P({__name:"ApproachesList",props:{modelValue:{},isBasedOnBodyWeight:{type:Boolean},weightUnit:{}},emits:["update:modelValue","delete-click"],setup(t,{emit:s}){const n=s,a=K(t,"modelValue",n);return(c,p)=>(x(),I(ve,{mode:"out-in",name:"fade"},{default:R(()=>[l(a).length?(x(),C("ul",Pt,[b(ge,{name:"fade"},{default:R(()=>[(x(!0),C(_e,null,me(l(a),(u,d)=>(x(),C("li",{class:"approaches-list__approach",key:u.id},[b(l(Bt),{"is-based-on-body-weight":c.isBasedOnBodyWeight,"weight-unit":c.weightUnit,index:d,approach:l(a)[d],"onUpdate:approach":o=>l(a)[d]=o,onDeleteClick:o=>n("delete-click",u.id)},null,8,["is-based-on-body-weight","weight-unit","index","approach","onUpdate:approach","onDeleteClick"])]))),128))]),_:1})])):(x(),C("p",At,"Подходы пока не добавлены"))]),_:1}))}});const zt=A(Ut,[["__scopeId","data-v-45bc9644"]]),Lt={class:"name-input"},Nt=P({__name:"NameInput",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:s}){const a=K(t,"modelValue",s);return(c,p)=>(x(),C("label",Lt,[Ne(k("input",{"onUpdate:modelValue":p[0]||(p[0]=u=>N(a)?a.value=u:null),type:"text",placeholder:"Введите название",class:"name-input__input"},null,512),[[We,l(a)]])]))}});const Wt=A(Nt,[["__scopeId","data-v-fae79cea"]]),Mt={class:"action-buttons"},Ft=P({__name:"ActionButtons",props:{disabled:{type:Boolean}},emits:["add-approach-click","save-click"],setup(t,{emit:s}){const n=s;return(e,a)=>(x(),C("div",Mt,[b(l(H),{class:"action-buttons__add-button",size:"m",variant:"outline",wide:"",onClick:a[0]||(a[0]=c=>n("add-approach-click"))},{default:R(()=>[b(l(J),{name:"plus"}),j(" Добавить подход ")]),_:1}),b(l(H),{disabled:e.disabled,size:"m",wide:"",onClick:a[1]||(a[1]=c=>n("save-click"))},{default:R(()=>[j(" Сохранить ")]),_:1},8,["disabled"])]))}});const qt=A(Ft,[["__scopeId","data-v-0e9f1c3d"]]),Gt={class:"exercise-detail-modal__container container"},Jt={key:0},Ht=P({__name:"ExerciseDetailModal",setup(t,{expose:s}){const n=$e(),e=qe(),a=V(null),c=V(),p=V(),u=()=>({bodyWeight:!1,weightUnit:e.settings.weightUnit}),d=V(u()),o=()=>({name:"",approaches:[],id:new Date().toISOString(),isBasedOnBodyWeight:!1,weightUnit:d.value.weightUnit}),i=V(o()),f={name:{required:tt}},{validation:$}=gt(f,i),g=()=>{const _=i.value.approaches[i.value.approaches.length-1]??{weightUnit:d.value.weightUnit,weight:0,reps:0,id:new Date().toISOString()};i.value.approaches.push({..._})},r=_=>{const E=i.value.approaches.findIndex(O=>O.id===_);i.value.approaches.splice(E,1)},m=()=>{a.value=null,d.value=u(),i.value=o()},v=async()=>{var _;await $.value.$validate()&&(a.value?n.editExercise(a.value.date,i.value):n.addExercise(i.value),(_=c.value)==null||_.close())},y=()=>{var _;(_=p.value)==null||_.open()},M=()=>{var _;a.value&&(n.deleteExercise(a.value.date,a.value.exerciseId),(_=c.value)==null||_.close())};T(()=>d.value.weightUnit,_=>{i.value.weightUnit=_}),T(()=>d.value.bodyWeight,_=>{i.value.isBasedOnBodyWeight=_});const z=h(()=>{const{pastTraining:_}=n;return _==null?void 0:_.exercises.find(({name:E})=>E===i.value.name)});return s({open:_=>{var F;if((F=c.value)==null||F.open(),!_)return;const E=n.getTrainingByDate(_.date);if(!E)return;const O=E.exercises.find(L=>L.id===(_==null?void 0:_.exerciseId));O&&(i.value=ht(O),d.value={weightUnit:O.weightUnit,bodyWeight:O.isBasedOnBodyWeight},a.value={exerciseId:_.exerciseId,date:_.date})},close:()=>{var _;return(_=c.value)==null?void 0:_.close()}}),(_,E)=>(x(),I(l(Fe),{"full-height":"",ref_key:"bottomSheet",ref:c,class:"exercise-detail-modal",onOnClose:m},{default:R(()=>[k("div",Gt,[b(l(Wt),{modelValue:i.value.name,"onUpdate:modelValue":E[0]||(E[0]=O=>i.value.name=O)},null,8,["modelValue"]),b(l(Tt),{modelValue:d.value,"onUpdate:modelValue":E[1]||(E[1]=O=>d.value=O),class:"exercise-detail-modal__top-bar","hide-deletion":!!a.value,onDeleteExerciseClick:y},null,8,["modelValue","hide-deletion"]),b(l(zt),{"weight-unit":d.value.weightUnit,modelValue:i.value.approaches,"onUpdate:modelValue":E[2]||(E[2]=O=>i.value.approaches=O),"is-based-on-body-weight":i.value.isBasedOnBodyWeight,onDeleteClick:r},null,8,["weight-unit","modelValue","is-based-on-body-weight"]),z.value?(x(),C("p",Jt,"Прошлое занятие")):W("",!0),z.value?(x(),I(ye,{key:1,exercise:z.value},null,8,["exercise"])):W("",!0),b(l(qt),{onAddApproachClick:g,onSaveClick:v,disabled:l($).$invalid},null,8,["disabled"])]),b(l(Ge),{ref_key:"deletionConfirmModal",ref:p,text:"Удалить упражнение?",onConfirm:M},null,512)]),_:1},512))}});const Zt=A(Ht,[["__scopeId","data-v-58b349a2"]]),Kt={key:0,class:"training__exercises"},Qt={key:1,class:"training__empty"},Xt={class:"container"},Yt=P({__name:"training",setup(t){const s=Me(),n=$e(),e=V();n.setSelectedDate(s.query.date?new Date(s.query.date):new Date);const a=h(()=>s.query.date?ie(new Date(s.query.date)):ie(new Date));s.query.date&&n.startTrainingByDate(new Date(s.query.date));const c=()=>{var u;n.startTraining(),(u=e.value)==null||u.open()},p=u=>{var o,i;const d=(o=n.selectedDayTraining)==null?void 0:o.date;d&&((i=e.value)==null||i.open({exerciseId:u,date:new Date(d)}))};return(u,d)=>(x(),I(l(Je),{class:"training"},{header:R(()=>[b(l(He),{title:a.value,"screen-title":"Тренировка"},null,8,["title"])]),footer:R(()=>[k("div",Xt,[l(n).selectedDayTraining?(x(),I(l(he),{key:0,class:"training__add",size:"m",icon:"plus",onClick:d[0]||(d[0]=o=>{var i;return(i=e.value)==null?void 0:i.open()})})):(x(),I(l(H),{key:1,size:"m",wide:"",onClick:c},{default:R(()=>[j(" Начать тренировку ")]),_:1}))])]),default:R(()=>{var o;return[(o=l(n).selectedDayTraining)!=null&&o.exercises.length?(x(),C("ul",Kt,[b(ge,{name:"fade"},{default:R(()=>[(x(!0),C(_e,null,me(l(n).selectedDayTraining.exercises,(i,f)=>(x(),C("li",{class:"training__exercise",key:f},[b(l(ye),{"can-edit":"",exercise:i,onEditClick:()=>p(i.id)},null,8,["exercise","onEditClick"])]))),128))]),_:1})])):(x(),C("p",Qt,"Добавте упражнения")),b(l(Zt),{ref_key:"exerciseModal",ref:e},null,512)]}),_:1}))}});const an=A(Yt,[["__scopeId","data-v-716ceeb7"]]);export{an as Training};
