import{T as O,u as N,B as A,M as R,f as U}from"./formatDate-92e7a765.js";import{d as Y,r as L,t as j,c as E,a as V,o as i,b as d,w as G,v as J,u as n,e as w,i as K,f as k,g as h,h as y,j as T,k as P,l as f,m as M,n as Q,F as B,p as $,q as x,s as W,x as F}from"./index-58dd6152.js";import{u as X,V as z,_ as C,a as S}from"./VButton-d0f617e5.js";import{V as Z}from"./VModal-ee9f6c6e.js";const q=Y("calendar",()=>{const _=L({currentMonth:new Date().toISOString().slice(0,7)}),l=s=>_.currentMonth=s;return{...j(_),setMonth:l}}),ee=_=>E(new Intl.DateTimeFormat("ru",{month:"long"}).format(_)),te={class:"month-picker"},ae=V({__name:"VMonthPicker",props:{modelValue:{default:new Date().toISOString().slice(0,7)}},emits:["update:modelValue"],setup(_,{emit:l}){const t=X(_,"modelValue",l);return(o,c)=>(i(),d("label",te,[G(w("input",{class:"month-picker__input","onUpdate:modelValue":c[0]||(c[0]=m=>K(t)?t.value=m:null),type:"month",id:"start",name:"start"},null,512),[[J,n(t)]]),k(" "+h(n(ee)(new Date(n(t))))+" ",1),y(z,{class:"month-picker__icon",name:"arrow-down",width:"24",height:"24"})]))}});const ne=C(ae,[["__scopeId","data-v-96a3d977"]]),se={class:"home-top-bar"},oe=V({__name:"HomeTopBar",setup(_,{emit:l}){const s=q(),t=T(s.currentMonth);return P(t,()=>s.setMonth(t.value)),(o,c)=>(i(),d("div",se,[y(n(O),null,{default:f(()=>[y(n(ne),{modelValue:t.value,"onUpdate:modelValue":c[0]||(c[0]=m=>t.value=m)},null,8,["modelValue"])]),_:1})]))}});const re=C(oe,[["__scopeId","data-v-77a001d4"]]),ce={class:"calendar-day__badge"},ie=V({__name:"VCalendarDay",props:{day:{},month:{},hasTraining:{type:Boolean}},setup(_,{emit:l}){const s=_,t=new Date,o=M(()=>({"calendar-day--active":s.day===t.getDate()&&s.month===t.getMonth(),"calendar-day--has-training":s.hasTraining}));return(c,m)=>(i(),d("button",{class:Q(["calendar-day",o.value])},[k(h(c.day)+" ",1),w("span",ce,[y(z,{class:"calendar-day__badge-icon",name:"dumb",width:"19",height:"11"})])],2))}});const le=C(ie,[["__scopeId","data-v-85ec8539"]]),_e={class:"calendar"},ue=V({__name:"VCalendar",props:{currentDate:{},isTrainingDayChecker:{type:Function}},emits:["day-click"],setup(_,{emit:l}){const s=_,t=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],o=T(s.currentDate);P(()=>s.currentDate,a=>{o.value=a});const c=(a,r)=>{const e=new Date(a,r,1),p=new Date(a,r+1,1);return Math.round((Number(p)-Number(e))/1e3/3600/24)},m=M(()=>{const a=o.value.getFullYear(),r=o.value.getMonth();return c(a,r)}),D=M(()=>{const a=[],r=(u,v)=>({day:v,month:u.getMonth(),year:u.getFullYear()});for(let u=1;u<=m.value;u++)a.push(r(o.value,u));const e=new Date(o.value);e.setDate(1);const p=e.getDay()===0?e.getDay()+7-1:e.getDay()-1,g=c(e.getFullYear(),e.getMonth()-1),b=[];for(let u=g+1-p;u<=g;u++){const v=new Date(o.value);v.setMonth(o.value.getMonth()-1),b.push(r(v,u))}e.setDate(m.value);const H=e.getDay()>0?7-e.getDay():0,I=[];for(let u=1;u<=H;u++){const v=new Date(o.value);v.setMonth(o.value.getMonth()+1),I.push(r(v,u))}return[...b,...a,...I]});return(a,r)=>(i(),d("div",_e,[(i(),d(B,null,$(t,e=>w("div",{key:e,class:"calendar__day-name"},h(e),1)),64)),(i(!0),d(B,null,$(D.value,({day:e,month:p,year:g})=>(i(),x(n(le),{key:`${e}${p}${g}`,day:e,month:p,class:"calendar__day","has-training":a.isTrainingDayChecker(new Date(`${p+1}/${e}/${g}`)),onClick:b=>l("day-click",new Date(`${p+1}/${e}/${g}`))},null,8,["day","month","has-training","onClick"]))),128))]))}});const de=C(ue,[["__scopeId","data-v-0418e738"]]),pe={class:"day-info-popup"},me={key:0,class:"day-info-popup__list"},ye={class:"day-info-popup__exercise-title"},he={key:0,class:"day-info-popup__approaches-list"},ge={class:"day-info-popup__approach-reps"},fe={key:1,class:"day-info-popup__empty"},De={class:"day-info-popup__actions"},ve=V({__name:"DayInfoPopup",props:{date:{}},setup(_){const l=_,s=W(),t=N(),o=M(()=>l.date&&t.getTrainingByDate(l.date)?"Изменть":"Заполнить день"),c=M(()=>l.date&&!!t.getTrainingByDate(l.date)),m=()=>{l.date&&(t.copyTraining(l.date),s.push({name:"training",query:{mode:"new-training"}}))};return(D,a)=>{var r;return i(),d("div",pe,[D.date&&n(t).getTrainingByDate(D.date)?(i(),d("ul",me,[(i(!0),d(B,null,$(n(t).getTrainingByDate(D.date).exercises,e=>(i(),d("li",{key:e.name,class:"day-info-popup__item"},[w("div",ye,h(e.name),1),e.approaches?(i(),d("ul",he,[(i(!0),d(B,null,$(e.approaches,(p,g)=>(i(),d("li",{key:g,class:"day-info-popup__approaches-list-item"},[k(h(g+1)+" подход ",1),w("span",ge,h(p.weight)+" "+h(p.weightUnit)+" x "+h(p.reps),1)]))),128))])):F("",!0)]))),128))])):(i(),d("p",fe,"Тренировок в этот день не было, но вы можете заполнить этот день")),w("div",De,[y(n(S),{wide:"",size:"m",to:{name:"training",query:{date:(r=D.date)==null?void 0:r.toISOString()}}},{default:f(()=>[k(h(o.value),1)]),_:1},8,["to"]),c.value?(i(),x(n(S),{key:0,wide:"",size:"m",onClick:m},{default:f(()=>[k(" Скопировать этот план ")]),_:1})):F("",!0)])])}}});const we=C(ve,[["__scopeId","data-v-b2f5a2f2"]]),ke=V({__name:"home",setup(_){const l=q(),s=N(),t=M(()=>{var a;return(a=s.todayTraining)!=null&&a.isFinished?"Изменить тренировку":s.todayTraining?"К тренировке":"Начать тренировку"}),o=T(),c=T(new Date),m=async a=>{var r;(r=o.value)==null||r.open(),c.value=a},D=a=>!!s.getTrainingByDate(a);return(a,r)=>(i(),x(n(A),{class:"home"},{header:f(()=>[y(n(re))]),footer:f(()=>[y(n(R),null,{default:f(()=>[y(n(S),{to:{name:"training",query:{mode:"new-training"}},size:"m",wide:""},{default:f(()=>[k(h(t.value),1)]),_:1})]),_:1})]),default:f(()=>[y(n(de),{"current-date":new Date(n(l).currentMonth),onDayClick:m,class:"home__calendar","is-training-day-checker":D},null,8,["current-date"]),y(n(Z),{ref_key:"bottomSheet",ref:o,"sub-title":n(U)(c.value),title:"Тренировка",onOnClose:r[0]||(r[0]=e=>c.value=new Date)},{default:f(()=>[y(n(we),{date:c.value},null,8,["date"])]),_:1},8,["sub-title"])]),_:1}))}});const Be=C(ke,[["__scopeId","data-v-a0b79926"]]);export{Be as Home};
