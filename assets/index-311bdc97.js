import{u as o,y as Ie,r as V,z as je,w as T,k as N,p as te,A as Te,c as g,B as Ae,C as Pe,D as se,E as ae,G as re,d as A,o as w,a as k,g as C,t as M,l as x,V as F,h as I,e as X,b as j,H as ze,I as Le,_ as P,s as R,T as fe,F as ve,f as _e,J as me,j as Ue,v as Ne,K as Me}from"./index-2fb8e712.js";import{u as J,V as q,a as We}from"./VButton-e8ba25eb.js";import{w as Y,V as $e,u as ge,a as Fe,D as qe,S as Ge,T as Je,E as He,f as oe}from"./DeletionConfirmModal-d167dcd1.js";import{V as Ze,a as Ke,b as Qe,c as Xe}from"./VSelect-db5f378d.js";const he=t=>{if(t=o(t),Array.isArray(t))return!!t.length;if(t==null)return!1;if(t===!1)return!0;if(t instanceof Date)return!isNaN(t.getTime());if(typeof t=="object"){for(let s in t)return!0;return!1}return!!String(t).length};function z(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return e=>(e=o(e),!he(e)||s.every(a=>(a.lastIndex=0,a.test(e))))}z(/^[a-zA-Z]*$/);z(/^[a-zA-Z0-9]*$/);z(/^\d*(\.\d+)?$/);const Ye=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;z(Ye);function et(t){return typeof t=="string"&&(t=t.trim()),he(t)}var tt={$validator:et,$message:"Value is required",$params:{type:"required"}};const nt=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i;z(nt);z(/(^[0-9]*$)|(^-[0-9]+$)/);z(/^[-]?\d*(\.\d+)?$/);function ie(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);s&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,e)}return n}function B(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?ie(Object(n),!0).forEach(function(e){st(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function st(t,s,n){return s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function le(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(t).reduce((n,e)=>(s.includes(e)||(n[e]=o(t[e])),n),{})}function G(t){return typeof t=="function"}function at(t){return Ae(t)||Pe(t)}function ye(t,s,n){let e=t;const a=s.split(".");for(let u=0;u<a.length;u++){if(!e[a[u]])return n;e=e[a[u]]}return e}function Q(t,s,n){return g(()=>t.some(e=>ye(s,e,{[n]:!1})[n]))}function ce(t,s,n){return g(()=>t.reduce((e,a)=>{const u=ye(s,a,{[n]:!1})[n]||[];return e.concat(u)},[]))}function xe(t,s,n,e){return t.call(e,o(s),o(n),e)}function be(t){return t.$valid!==void 0?!t.$valid:!t}function rt(t,s,n,e,a,u,p){let{$lazy:c,$rewardEarly:l}=a,i=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],d=arguments.length>8?arguments[8]:void 0,f=arguments.length>9?arguments[9]:void 0,h=arguments.length>10?arguments[10]:void 0;const m=V(!!e.value),r=V(0);n.value=!1;const _=T([s,e].concat(i,h),()=>{if(c&&!e.value||l&&!f.value&&!n.value)return;let v;try{v=xe(t,s,d,p)}catch(y){v=Promise.reject(y)}r.value++,n.value=!!r.value,m.value=!1,Promise.resolve(v).then(y=>{r.value--,n.value=!!r.value,u.value=y,m.value=be(y)}).catch(y=>{r.value--,n.value=!!r.value,u.value=y,m.value=!0})},{immediate:!0,deep:typeof s=="object"});return{$invalid:m,$unwatch:_}}function ot(t,s,n,e,a,u,p,c){let{$lazy:l,$rewardEarly:i}=e;const d=()=>({}),f=g(()=>{if(l&&!n.value||i&&!c.value)return!1;let h=!0;try{const m=xe(t,s,p,u);a.value=m,h=be(m)}catch(m){a.value=m}return h});return{$unwatch:d,$invalid:f}}function it(t,s,n,e,a,u,p,c,l,i,d){const f=V(!1),h=t.$params||{},m=V(null);let r,_;t.$async?{$invalid:r,$unwatch:_}=rt(t.$validator,s,f,n,e,m,a,t.$watchTargets,l,i,d):{$invalid:r,$unwatch:_}=ot(t.$validator,s,n,e,m,a,l,i);const v=t.$message;return{$message:G(v)?g(()=>v(le({$pending:f,$invalid:r,$params:le(h),$model:s,$response:m,$validator:u,$propertyPath:c,$property:p}))):v||"",$params:h,$pending:f,$invalid:r,$response:m,$unwatch:_}}function lt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=o(t),n=Object.keys(s),e={},a={},u={};let p=null;return n.forEach(c=>{const l=s[c];switch(!0){case G(l.$validator):e[c]=l;break;case G(l):e[c]={$validator:l};break;case c==="$validationGroups":p=l;break;case c.startsWith("$"):u[c]=l;break;default:a[c]=l}}),{rules:e,nestedValidators:a,config:u,validationGroups:p}}const ct="__root";function ut(t,s,n,e,a,u,p,c,l){const i=Object.keys(t),d=e.get(a,t),f=V(!1),h=V(!1),m=V(0);if(d){if(!d.$partial)return d;d.$unwatch(),f.value=d.$dirty.value}const r={$dirty:f,$path:a,$touch:()=>{f.value||(f.value=!0)},$reset:()=>{f.value&&(f.value=!1)},$commit:()=>{}};return i.length?(i.forEach(_=>{r[_]=it(t[_],s,r.$dirty,u,p,_,n,a,l,h,m)}),r.$externalResults=g(()=>c.value?[].concat(c.value).map((_,v)=>({$propertyPath:a,$property:n,$validator:"$externalResults",$uid:`${a}-externalResult-${v}`,$message:_,$params:{},$response:null,$pending:!1})):[]),r.$invalid=g(()=>{const _=i.some(v=>o(r[v].$invalid));return h.value=_,!!r.$externalResults.value.length||_}),r.$pending=g(()=>i.some(_=>o(r[_].$pending))),r.$error=g(()=>r.$dirty.value?r.$pending.value||r.$invalid.value:!1),r.$silentErrors=g(()=>i.filter(_=>o(r[_].$invalid)).map(_=>{const v=r[_];return te({$propertyPath:a,$property:n,$validator:_,$uid:`${a}-${_}`,$message:v.$message,$params:v.$params,$response:v.$response,$pending:v.$pending})}).concat(r.$externalResults.value)),r.$errors=g(()=>r.$dirty.value?r.$silentErrors.value:[]),r.$unwatch=()=>i.forEach(_=>{r[_].$unwatch()}),r.$commit=()=>{h.value=!0,m.value=Date.now()},e.set(a,t,r),r):(d&&e.set(a,t,r),r)}function dt(t,s,n,e,a,u,p){const c=Object.keys(t);return c.length?c.reduce((l,i)=>(l[i]=ee({validations:t[i],state:s,key:i,parentKey:n,resultsCache:e,globalConfig:a,instance:u,externalResults:p}),l),{}):{}}function pt(t,s,n){const e=g(()=>[s,n].filter(r=>r).reduce((r,_)=>r.concat(Object.values(o(_))),[])),a=g({get(){return t.$dirty.value||(e.value.length?e.value.every(r=>r.$dirty):!1)},set(r){t.$dirty.value=r}}),u=g(()=>{const r=o(t.$silentErrors)||[],_=e.value.filter(v=>(o(v).$silentErrors||[]).length).reduce((v,y)=>v.concat(...y.$silentErrors),[]);return r.concat(_)}),p=g(()=>{const r=o(t.$errors)||[],_=e.value.filter(v=>(o(v).$errors||[]).length).reduce((v,y)=>v.concat(...y.$errors),[]);return r.concat(_)}),c=g(()=>e.value.some(r=>r.$invalid)||o(t.$invalid)||!1),l=g(()=>e.value.some(r=>o(r.$pending))||o(t.$pending)||!1),i=g(()=>e.value.some(r=>r.$dirty)||e.value.some(r=>r.$anyDirty)||a.value),d=g(()=>a.value?l.value||c.value:!1),f=()=>{t.$touch(),e.value.forEach(r=>{r.$touch()})},h=()=>{t.$commit(),e.value.forEach(r=>{r.$commit()})},m=()=>{t.$reset(),e.value.forEach(r=>{r.$reset()})};return e.value.length&&e.value.every(r=>r.$dirty)&&f(),{$dirty:a,$errors:p,$invalid:c,$anyDirty:i,$error:d,$pending:l,$touch:f,$reset:m,$silentErrors:u,$commit:h}}function ee(t){let{validations:s,state:n,key:e,parentKey:a,childResults:u,resultsCache:p,globalConfig:c={},instance:l,externalResults:i}=t;const d=a?`${a}.${e}`:e,{rules:f,nestedValidators:h,config:m,validationGroups:r}=lt(s),_=B(B({},c),m),v=e?g(()=>{const b=o(n);return b?o(b[e]):void 0}):n,y=B({},o(i)||{}),$=g(()=>{const b=o(i);return e?b?o(b[e]):void 0:b}),O=ut(f,v,e,p,d,_,l,$,n),E=dt(h,v,d,p,_,l,$),L={};r&&Object.entries(r).forEach(b=>{let[D,S]=b;L[D]={$invalid:Q(S,E,"$invalid"),$error:Q(S,E,"$error"),$pending:Q(S,E,"$pending"),$errors:ce(S,E,"$errors"),$silentErrors:ce(S,E,"$silentErrors")}});const{$dirty:U,$errors:Ve,$invalid:H,$anyDirty:Ee,$error:Oe,$pending:Z,$touch:K,$reset:Re,$silentErrors:Ce,$commit:ne}=pt(O,E,u),ke=e?g({get:()=>o(v),set:b=>{U.value=!0;const D=o(n),S=o(i);S&&(S[e]=y[e]),N(D[e])?D[e].value=b:D[e]=b}}):null;e&&_.$autoDirty&&T(v,()=>{U.value||K();const b=o(i);b&&(b[e]=y[e])},{flush:"sync"});async function Se(){return K(),_.$rewardEarly&&(ne(),await re()),await re(),new Promise(b=>{if(!Z.value)return b(!H.value);const D=T(Z,()=>{b(!H.value),D()})})}function Be(b){return(u.value||{})[b]}function De(){N(i)?i.value=y:Object.keys(y).length===0?Object.keys(i).forEach(b=>{delete i[b]}):Object.assign(i,y)}return te(B(B(B({},O),{},{$model:ke,$dirty:U,$error:Oe,$errors:Ve,$invalid:H,$anyDirty:Ee,$pending:Z,$touch:K,$reset:Re,$path:d||ct,$silentErrors:Ce,$validate:Se,$commit:ne},u&&{$getResultsForChild:Be,$clearExternalResults:De,$validationGroups:L}),E))}class ft{constructor(){this.storage=new Map}set(s,n,e){this.storage.set(s,{rules:n,result:e})}checkRulesValidity(s,n,e){const a=Object.keys(e),u=Object.keys(n);return u.length!==a.length||!u.every(c=>a.includes(c))?!1:u.every(c=>n[c].$params?Object.keys(n[c].$params).every(l=>o(e[c].$params[l])===o(n[c].$params[l])):!0)}get(s,n){const e=this.storage.get(s);if(!e)return;const{rules:a,result:u}=e,p=this.checkRulesValidity(s,n,a),c=u.$unwatch?u.$unwatch:()=>({});return p?u:{$dirty:u.$dirty,$partial:!0,$unwatch:c}}}const W={COLLECT_ALL:!0,COLLECT_NONE:!1},ue=Symbol("vuelidate#injectChildResults"),de=Symbol("vuelidate#removeChildResults");function vt(t){let{$scope:s,instance:n}=t;const e={},a=V([]),u=g(()=>a.value.reduce((d,f)=>(d[f]=o(e[f]),d),{}));function p(d,f){let{$registerAs:h,$scope:m,$stopPropagation:r}=f;r||s===W.COLLECT_NONE||m===W.COLLECT_NONE||s!==W.COLLECT_ALL&&s!==m||(e[h]=d,a.value.push(h))}n.__vuelidateInjectInstances=[].concat(n.__vuelidateInjectInstances||[],p);function c(d){a.value=a.value.filter(f=>f!==d),delete e[d]}n.__vuelidateRemoveInstances=[].concat(n.__vuelidateRemoveInstances||[],c);const l=se(ue,[]);ae(ue,n.__vuelidateInjectInstances);const i=se(de,[]);return ae(de,n.__vuelidateRemoveInstances),{childResults:u,sendValidationResultsToParent:l,removeValidationResultsFromParent:i}}function we(t){return new Proxy(t,{get(s,n){return typeof s[n]=="object"?we(s[n]):g(()=>s[n])}})}let pe=0;function _t(t,s){var n;let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(e=t,t=void 0,s=void 0);let{$registerAs:a,$scope:u=W.COLLECT_ALL,$stopPropagation:p,$externalResults:c,currentVueInstance:l}=e;const i=l||((n=Ie())===null||n===void 0?void 0:n.proxy),d=i?i.$options:{};a||(pe+=1,a=`_vuelidate_${pe}`);const f=V({}),h=new ft,{childResults:m,sendValidationResultsToParent:r,removeValidationResultsFromParent:_}=i?vt({$scope:u,instance:i}):{childResults:V({})};if(!t&&d.validations){const v=d.validations;s=V({}),je(()=>{s.value=i,T(()=>G(v)?v.call(s.value,new we(s.value)):v,y=>{f.value=ee({validations:y,state:s,childResults:m,resultsCache:h,globalConfig:e,instance:i,externalResults:c||i.vuelidateExternalResults})},{immediate:!0})}),e=d.validationsConfig||e}else{const v=N(t)||at(t)?t:te(t||{});T(v,y=>{f.value=ee({validations:y,state:s,childResults:m,resultsCache:h,globalConfig:e,instance:i??{},externalResults:c})},{immediate:!0})}return i&&(r.forEach(v=>v(f,{$registerAs:a,$scope:u,$stopPropagation:p})),Te(()=>_.forEach(v=>v(a)))),g(()=>B(B({},o(f.value)),m.value))}const mt=(t,s)=>{const n=String(s).split(".");let e=t;for(const a of n)if(e&&typeof e=="object"&&a in e)e=e[a];else return;return e},$t=(t,s)=>{const n=Object.keys(s),e=V({}),a=()=>{n.forEach(i=>e.value[i]=[])};a();const u=i=>e.value=i,p=_t(t,s,{$externalResults:e}),c=g(()=>i=>{var f,h,m;const d=(m=(h=(f=p.value[i])==null?void 0:f.$errors)==null?void 0:h[0])==null?void 0:m.$message;return(N(d)?d.value:d)??""});return{serverErrors:e,getError:c,validation:p,setInitialServerErrors:a,syncServerErrors:u,touch:i=>{var d,f;(f=(d=mt(p.value,i))==null?void 0:d.$touch)==null||f.call(d)}}},gt=t=>{const s=JSON.stringify(t);return JSON.parse(s)},ht=t=>(ze("data-v-2142f5b2"),t=t(),Le(),t),yt={class:"exercise-approach"},xt={class:"exercise-approach__head"},bt={class:"exercise-approach__count"},wt={class:"exercise-approach__actions"},Vt={class:"exercise-approach__actions-group"},Et=ht(()=>C("div",{class:"exercise-approach__actions-title"},"Повторения",-1)),Ot={class:"exercise-approach__actions-group"},Rt={class:"exercise-approach__actions-title"},Ct={class:"exercise-approach__weight-input"},kt=A({__name:"ExerciseApproach",props:{approach:{},index:{},isBasedOnBodyWeight:{type:Boolean}},emits:["delete-click","update:approach"],setup(t,{emit:s}){const n=s,e=t,a=J(e,"approach",n),u=g(()=>{const p=Y[e.approach.weightUnit];return`${e.isBasedOnBodyWeight?"Доп. вес":"Вес"} (${p})`});return(p,c)=>(w(),k("div",yt,[C("div",xt,[C("div",bt,M(p.index+1)+" подход ",1),C("button",{type:"button",class:"exercise-approach__delete",onClick:c[0]||(c[0]=l=>n("delete-click",p.approach.id))},[x(o(F),{name:"trash",width:"18",height:"18"})])]),C("div",wt,[C("div",Vt,[Et,x(o(Ze),{modelValue:o(a).reps,"onUpdate:modelValue":c[1]||(c[1]=l=>o(a).reps=l)},null,8,["modelValue"])]),C("div",Ot,[C("div",Rt,M(u.value),1),C("div",Ct,[p.isBasedOnBodyWeight?(w(),I(o(F),{key:0,class:"exercise-approach__weight-input-icon",name:"body",width:"25",height:"24"})):X("",!0),j(" "+M(p.isBasedOnBodyWeight?"+":null)+" ",1),x(o(Ke),{inputmode:"numeric",type:"number",modelValue:o(a).weight,"onUpdate:modelValue":c[2]||(c[2]=l=>o(a).weight=l)},null,8,["modelValue"])])])])]))}});const St=P(kt,[["__scopeId","data-v-2142f5b2"]]),Bt={class:"exercise-top-bar"},Dt={class:"exercise-top-bar__actions"},It={key:0,class:"exercise-top-bar__settings"},jt=A({__name:"ExerciseTopBar",props:{modelValue:{},hideDeletion:{type:Boolean}},emits:["update:modelValue","delete-exercise-click"],setup(t,{emit:s}){const n=V(!1),e=t,a=s,u=J(e,"modelValue",a),p=Object.keys(Y).map(l=>({title:Y[l],value:l})),c=g(()=>n.value?"Закрыть":"Параметры");return(l,i)=>(w(),k("div",Bt,[C("div",Dt,[x(o(q),{variant:"outline",onClick:i[0]||(i[0]=d=>n.value=!n.value)},{default:R(()=>[x(o(F),{name:"settings"}),j(" "+M(c.value),1)]),_:1}),l.hideDeletion?(w(),I(o($e),{key:0,theme:"dangerous",icon:"trash",onClick:i[1]||(i[1]=d=>a("delete-exercise-click"))})):X("",!0)]),x(fe,{name:"fade",mode:"out-in"},{default:R(()=>[n.value?(w(),k("div",It,[x(o(Qe),{modelValue:o(u).bodyWeight,"onUpdate:modelValue":i[2]||(i[2]=d=>o(u).bodyWeight=d)},{default:R(()=>[j("Собственный вес")]),_:1},8,["modelValue"]),x(o(Xe),{modelValue:o(u).weightUnit,"onUpdate:modelValue":i[3]||(i[3]=d=>o(u).weightUnit=d),options:o(p)},{default:R(()=>[j("Ед. Измерения")]),_:1},8,["modelValue","options"])])):X("",!0)]),_:1})]))}});const Tt=P(jt,[["__scopeId","data-v-3d6f6688"]]),At={key:0,class:"approaches-list"},Pt={key:1,class:"empty-message"},zt=A({__name:"ApproachesList",props:{modelValue:{},isBasedOnBodyWeight:{type:Boolean}},emits:["update:modelValue","delete-click"],setup(t,{emit:s}){const n=s,a=J(t,"modelValue",n);return(u,p)=>(w(),I(fe,{mode:"out-in",name:"fade"},{default:R(()=>[o(a).length?(w(),k("ul",At,[x(me,{name:"fade"},{default:R(()=>[(w(!0),k(ve,null,_e(o(a),(c,l)=>(w(),k("li",{class:"approaches-list__approach",key:c.id},[x(o(St),{"is-based-on-body-weight":u.isBasedOnBodyWeight,index:l,approach:o(a)[l],"onUpdate:approach":i=>o(a)[l]=i,onDeleteClick:i=>n("delete-click",c.id)},null,8,["is-based-on-body-weight","index","approach","onUpdate:approach","onDeleteClick"])]))),128))]),_:1})])):(w(),k("p",Pt,"Подходы пока не добавлены"))]),_:1}))}});const Lt=P(zt,[["__scopeId","data-v-22d9e1ab"]]),Ut={class:"name-input"},Nt=A({__name:"NameInput",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:s}){const a=J(t,"modelValue",s);return(u,p)=>(w(),k("label",Ut,[Ue(C("input",{"onUpdate:modelValue":p[0]||(p[0]=c=>N(a)?a.value=c:null),type:"text",placeholder:"Введите название",class:"name-input__input"},null,512),[[Ne,o(a)]])]))}});const Mt=P(Nt,[["__scopeId","data-v-fae79cea"]]),Wt={class:"action-buttons"},Ft=A({__name:"ActionButtons",props:{disabled:{type:Boolean}},emits:["add-approach-click","save-click"],setup(t,{emit:s}){const n=s;return(e,a)=>(w(),k("div",Wt,[x(o(q),{class:"action-buttons__add-button",size:"m",variant:"outline",wide:"",onClick:a[0]||(a[0]=u=>n("add-approach-click"))},{default:R(()=>[x(o(F),{name:"plus"}),j(" Добавить подход ")]),_:1}),x(o(q),{disabled:e.disabled,size:"m",wide:"",onClick:a[1]||(a[1]=u=>n("save-click"))},{default:R(()=>[j(" Сохранить ")]),_:1},8,["disabled"])]))}});const qt=P(Ft,[["__scopeId","data-v-0e9f1c3d"]]),Gt={class:"exercise-detail-modal__container container"},Jt=A({__name:"ExerciseDetailModal",setup(t,{expose:s}){const n=ge(),e=Fe(),a=V(null),u=V(),p=V(),c=()=>({name:"",approaches:[],id:new Date().toISOString(),isBasedOnBodyWeight:!1}),l=V(c()),i={name:{required:tt}},{validation:d}=$t(i,l),f=V({bodyWeight:!1,weightUnit:e.settings.weightUnit}),h=()=>{const $=l.value.approaches[l.value.approaches.length-1]??{weightUnit:f.value.weightUnit,weight:0,reps:0,id:new Date().toISOString()};l.value.approaches.push({...$})},m=$=>{const O=l.value.approaches.findIndex(E=>E.id===$);l.value.approaches.splice(O,1)},r=()=>{a.value=null,l.value=c()},_=async()=>{var $;await d.value.$validate()&&(a.value?n.editExercise(a.value.date,l.value):n.addExercise(l.value),($=u.value)==null||$.close())},v=()=>{var $;($=p.value)==null||$.open()},y=()=>{var $;a.value&&(n.deleteExercise(a.value.date,a.value.exerciseId),($=u.value)==null||$.close())};return T(()=>f.value.weightUnit,$=>{l.value.approaches.forEach(O=>{O.weightUnit=$})}),T(()=>f.value.bodyWeight,$=>{l.value.isBasedOnBodyWeight=$}),s({open:$=>{var L;if((L=u.value)==null||L.open(),!$)return;const O=n.getTrainingByDate($.date);if(!O)return;const E=O.exercises.find(U=>U.id===($==null?void 0:$.exerciseId));E&&(l.value=gt(E),a.value={exerciseId:$.exerciseId,date:$.date})},close:()=>{var $;return($=u.value)==null?void 0:$.close()}}),($,O)=>(w(),I(o(We),{"full-height":"",ref_key:"bottomSheet",ref:u,class:"exercise-detail-modal",onOnClose:r},{default:R(()=>[C("div",Gt,[x(o(Mt),{modelValue:l.value.name,"onUpdate:modelValue":O[0]||(O[0]=E=>l.value.name=E)},null,8,["modelValue"]),x(o(Tt),{modelValue:f.value,"onUpdate:modelValue":O[1]||(O[1]=E=>f.value=E),class:"exercise-detail-modal__top-bar","hide-deletion":!!a.value,onDeleteExerciseClick:v},null,8,["modelValue","hide-deletion"]),x(o(Lt),{modelValue:l.value.approaches,"onUpdate:modelValue":O[2]||(O[2]=E=>l.value.approaches=E),"is-based-on-body-weight":l.value.isBasedOnBodyWeight,onDeleteClick:m},null,8,["modelValue","is-based-on-body-weight"]),x(o(qt),{onAddApproachClick:h,onSaveClick:_,disabled:o(d).$invalid},null,8,["disabled"])]),x(o(qe),{ref_key:"deletionConfirmModal",ref:p,text:"Удалить упражнение?",onConfirm:y},null,512)]),_:1},512))}});const Ht=P(Jt,[["__scopeId","data-v-22fcd85d"]]),Zt={key:0,class:"training__exercises"},Kt={key:1,class:"training__empty"},Qt={class:"container"},Xt=A({__name:"training",setup(t){const s=Me(),n=ge(),e=V();n.setSelectedDate(s.query.date?new Date(s.query.date):new Date);const a=g(()=>s.query.date?oe(new Date(s.query.date)):oe(new Date));s.query.date&&n.startTrainingByDate(new Date(s.query.date));const u=()=>{var c;n.startTraining(),(c=e.value)==null||c.open()},p=c=>{var i,d;const l=(i=n.selectedDayTraining)==null?void 0:i.date;l&&((d=e.value)==null||d.open({exerciseId:c,date:new Date(l)}))};return(c,l)=>(w(),I(o(Ge),{class:"training"},{header:R(()=>[x(o(Je),{title:a.value,"screen-title":"Тренировка"},null,8,["title"])]),footer:R(()=>[C("div",Qt,[o(n).selectedDayTraining?(w(),I(o($e),{key:0,class:"training__add",size:"m",icon:"plus",onClick:l[0]||(l[0]=i=>{var d;return(d=e.value)==null?void 0:d.open()})})):(w(),I(o(q),{key:1,size:"m",wide:"",onClick:u},{default:R(()=>[j(" Начать тренировку ")]),_:1}))])]),default:R(()=>{var i;return[(i=o(n).selectedDayTraining)!=null&&i.exercises.length?(w(),k("ul",Zt,[x(me,{name:"fade"},{default:R(()=>[(w(!0),k(ve,null,_e(o(n).selectedDayTraining.exercises,(d,f)=>(w(),k("li",{class:"training__exercise",key:f},[x(o(He),{"can-edit":"",exercise:d,onEditClick:()=>p(d.id)},null,8,["exercise","onEditClick"])]))),128))]),_:1})])):(w(),k("p",Kt,"Добавте упражнения")),x(o(Ht),{ref_key:"exerciseModal",ref:e},null,512)]}),_:1}))}});const sn=P(Xt,[["__scopeId","data-v-98be0c82"]]);export{sn as Training};
