import{d as v,c as V,o as i,a as p,b as T,t as B,e as I,n as O,_ as k,r as C,w as P,F as $,f as x,g as b,h as w,u as s,i as q,j as E,v as R,k as Y,l as y,V as L,m as U,p as j,q as G,s as D,x as J}from"./index-812ead96.js";import{u as K,T as Q,a as z,V as N,E as W,S as X,b as Z,f as ee,c as te,D as ae}from"./DeletionConfirmModal-ea25c62d.js";const ne={key:0,class:"calendar-day__point"},se=v({__name:"VCalendarDay",props:{day:{},month:{},hasTraining:{type:Boolean}},setup(u,{emit:r}){const o=u,c=new Date,l=V(()=>({"calendar-day--active":o.day===c.getDate()&&o.month===c.getMonth(),"calendar-day--has-training":o.hasTraining}));return(t,m)=>(i(),p("button",{type:"button",class:O(["calendar-day",l.value])},[T(B(t.day)+" ",1),t.hasTraining?(i(),p("span",ne)):I("",!0)],2))}});const oe=k(se,[["__scopeId","data-v-c0e15ed5"]]),re={class:"calendar"},ce=v({__name:"VCalendar",props:{currentDate:{},isTrainingDayChecker:{type:Function}},emits:["day-click"],setup(u,{emit:r}){const o=r,c=u,l=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],t=C(c.currentDate);P(()=>c.currentDate,a=>{t.value=a});const m=(a,n)=>{const e=new Date(a,n,1),h=new Date(a,n+1,1);return Math.round((Number(h)-Number(e))/1e3/3600/24)},_=V(()=>{const a=t.value.getFullYear(),n=t.value.getMonth();return m(a,n)}),M=V(()=>{const a=[],n=(d,g)=>({day:g,month:d.getMonth(),year:d.getFullYear()});for(let d=1;d<=_.value;d++)a.push(n(t.value,d));const e=new Date(t.value);e.setDate(1);const h=e.getDay()===0?e.getDay()+7-1:e.getDay()-1,f=m(e.getFullYear(),e.getMonth()-1),S=[];for(let d=f+1-h;d<=f;d++){const g=new Date(t.value);g.setMonth(t.value.getMonth()-1),S.push(n(g,d))}e.setDate(_.value);const H=e.getDay()>0?7-e.getDay():0,F=[];for(let d=1;d<=H;d++){const g=new Date(t.value);g.setMonth(t.value.getMonth()+1),F.push(n(g,d))}return[...S,...a,...F]});return(a,n)=>(i(),p("div",re,[(i(),p($,null,x(l,e=>b("div",{key:e,class:"calendar__day-name"},B(e),1)),64)),(i(!0),p($,null,x(M.value,({day:e,month:h,year:f})=>(i(),w(s(oe),{key:`${e}${h}${f}`,day:e,month:h,class:"calendar__day","has-training":a.isTrainingDayChecker(new Date(`${h+1}/${e}/${f}`)),onClick:S=>o("day-click",new Date(`${h+1}/${e}/${f}`))},null,8,["day","month","has-training","onClick"]))),128))]))}});const le=k(ce,[["__scopeId","data-v-d90e1dd8"]]),ie=u=>q(new Intl.DateTimeFormat("ru",{month:"long"}).format(u)),ue={class:"month-picker"},de=v({__name:"VMonthPicker",props:{modelValue:{default:new Date().toISOString().slice(0,7)}},emits:["update:modelValue"],setup(u,{emit:r}){const l=K(u,"modelValue",r);return(t,m)=>(i(),p("label",ue,[E(b("input",{class:"month-picker__input","onUpdate:modelValue":m[0]||(m[0]=_=>Y(l)?l.value=_:null),type:"month",id:"start",name:"start"},null,512),[[R,s(l)]]),T(" "+B(s(ie)(new Date(s(l))))+" ",1),y(L,{class:"month-picker__icon",name:"arrow-down",width:"24",height:"24"})]))}});const _e=k(de,[["__scopeId","data-v-aee16c11"]]),A=U("calendar",()=>{const u=j({currentMonth:new Date().toISOString().slice(0,7)}),r=o=>u.currentMonth=o;return{...G(u),setMonth:r}}),pe={class:"home-top-bar"},me=v({__name:"HomeTopBar",setup(u){const r=A(),o=C(r.currentMonth);return P(o,()=>r.setMonth(o.value)),(c,l)=>(i(),p("div",pe,[y(s(Q),null,{default:D(()=>[y(s(_e),{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=t=>o.value=t)},null,8,["modelValue"])]),_:1})]))}});const ye=k(me,[["__scopeId","data-v-7665f317"]]),he={class:"day-info-popup"},ge={key:0,class:"day-info-popup__list"},De={key:1,class:"day-info-popup__empty"},fe={class:"day-info-popup__actions"},ve=v({__name:"DayInfoPopup",props:{date:{}},setup(u){const r=u,o=J(),c=z(),l=V(()=>r.date&&c.getTrainingByDate(r.date)?"Изменть":"Заполнить день"),t=V(()=>r.date&&!!c.getTrainingByDate(r.date)),m=()=>{r.date&&(c.copyTraining(r.date),o.push({name:"training",query:{mode:"new-training"}}))};return(_,M)=>{var a,n;return i(),p("div",he,[_.date&&s(c).getTrainingByDate(_.date)?(i(),p("ul",ge,[(i(!0),p($,null,x((a=s(c).getTrainingByDate(_.date))==null?void 0:a.exercises,e=>(i(),w(W,{key:e.name,exercise:e},null,8,["exercise"]))),128))])):(i(),p("p",De,"Тренировок в этот день не было, но вы можете заполнить этот день")),b("div",fe,[y(s(N),{wide:"",size:"m",to:{name:"training",query:{date:(n=_.date)==null?void 0:n.toISOString()}}},{default:D(()=>[T(B(l.value),1)]),_:1},8,["to"]),t.value?(i(),w(s(N),{key:0,wide:"",size:"m",variant:"outline",onClick:m},{default:D(()=>[T(" Повторить этот план ")]),_:1})):I("",!0)])])}}});const ke=k(ve,[["__scopeId","data-v-bcc87d04"]]),Ce=v({__name:"home",setup(u){const r=A(),o=z(),c=C(),l=C(),t=C(new Date),m=async a=>{var n;(n=c.value)==null||n.open(),t.value=a},_=()=>{var a;o.deleteTraining(t.value),(a=c.value)==null||a.close()},M=a=>!!o.getTrainingByDate(a);return(a,n)=>(i(),w(s(X),{class:"home"},{header:D(()=>[y(s(ye),{class:"layout-header"})]),default:D(()=>[y(s(le),{"current-date":new Date(s(r).currentMonth),onDayClick:m,class:"home__calendar","is-training-day-checker":M},null,8,["current-date"]),y(s(te),{ref_key:"bottomSheet",ref:c,"sub-title":s(ee)(t.value),title:"Тренировка",onOnClose:n[1]||(n[1]=e=>t.value=new Date)},{actions:D(()=>[s(o).getTrainingByDate(t.value)?(i(),w(s(Z),{key:0,theme:"dangerous",icon:"trash",onClick:n[0]||(n[0]=()=>{var e;return(e=l.value)==null?void 0:e.open()})})):I("",!0)]),default:D(()=>[y(s(ke),{date:t.value},null,8,["date"])]),_:1},8,["sub-title"]),y(s(ae),{ref_key:"deletionBottomSheet",ref:l,text:"Удалить тренировку?",onConfirm:_},null,512)]),_:1}))}});const Me=k(Ce,[["__scopeId","data-v-f4e5f480"]]);export{Me as Home};
